# Проектирование и Архитектура Программных Систем
# Описание архитектуры
 COM объект реализует функции калькулятора матриц, а именно: сложение, вычитание и умножение матриц. Используем COM-объект в консольном клиенте, который был разработан для взаимодействия с пользователем и реализует выбор пользователем функции нашего COM объекта - калькулятора матриц - которые будут вызваны, вводить свои значения матриц, как аргументов функций COM-объекта, а также реализует вывод результата выполнения функций.
# Ответы на вопросы по лаборатороной работе №8
 1) Для взаимодействия COM объекта необходимо создать новую библиотеку классов и установить ей свойство "регистрация для COM-взаимодействия". В коде COM объекта необходимо создать класс ли интрефейс. Класс и интерфейс надо пометить рядом атриутов: следует указать для них уникальные GUID-ы, указать ComVisible(true), а для класса также добавить атрибут ClassInterface(ClassInterfaceType.None). После этого необходимо собрать проект. Также регистрацию COM-объекта можно провести вручную с помощью утилиты RegAsm.
 2) Свои функции COM объекты поставляют через интерфейс. Интерфейс - это указатель на функции, вызываемые клиентом. При взаимодействии между клиентом и объектом COM определяется:
 - уникальный идентификатор
 - местоположение функции в интерфейсе
 - назначение функции
 - аргументы и возвращаемое значение
 3) Библиотека COM предназначена для выполнения базовых функций и идентификации требуемого интерфейса. При попытке клиента использовать некоторый объект COM, который до этого момента не использовался и, следовательно, клиент не мог получить указатели на объект и интерфейс, он обращается к библиотеке COM и вызывает метод CoCreateInstance, передавая ей в качестве параметра CLSID нужного класса, IDD интерфейса и требуемый тип сервера. Библиотека при помощи диспетчера управления службами обращается к системному реестру, по идентификатору класса находит информацию о сервере и запускает его. Сервер создает экземпляр класса - объект, и возвращает библиотеке указатель на запрошенный интерфейс. Библиотека COM передает указатель клиенту, который впоследствии может образаться неосредственно к объекту.
 4) COM-сервер - это специальным образом оформленное и зарегистрированное в системе приложение, которое позволяет клиентам запрашивать у себя создание реализованных в нем объектов. Сервер может быть выполнен в виде либо динамической библиотеки, либо исполняемого файла.